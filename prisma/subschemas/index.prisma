import { Entry } from "rules"

model Rules {
  title        String @id @unique
  config       Boolean  @default(true)
  src          String   @default("core-rules")
  last_updated DateTime @default("1980-01-01T01:00:00-05:00")
}

model Index {
  id    String @unique
  table String
}

model Description {
  entryId String    @id @unique
  content Content[] @relation("source")
  entry   Entry?    @relation(fields: [entryId], references: [id])
}

model Content {
  index     Int
  src       Description @relation("source", fields: [srcId], references: [entryId])
  srcId     String
  plaintext String      @db.MediumText
  link      Link?

  @@id(name: "id", [index, srcId])
  @@unique([index, srcId])
}

model Link {
  content  Content @relation(fields: [contentIndex, contentSrc], references: [index, srcId])
  target   Entry   @relation("target", fields: [targetId], references: [id])
  targetId String

  contentIndex Int
  contentSrc   String

  @@id(name: "id", [contentIndex, contentSrc])
  @@unique([contentIndex, contentSrc])
}
